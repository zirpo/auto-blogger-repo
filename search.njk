---
title: Search
layout: base.njk
permalink: /search/
---
<h1>Search</h1>
<input type="search" id="searchInput" placeholder="Search posts..." />
<ul id="searchResults"></ul>

<script src="https://cdn.jsdelivr.net/npm/lunr/lunr.min.js"></script>
<script>
let index, posts;
const searchInput = document.getElementById('searchInput');
const resultsList = document.getElementById('searchResults');

fetch('/search.json')
  .then(res => res.json())
  .then(data => {
    posts = data;
    index = lunr(function () {
      this.field('title');
      this.ref('url');
      posts.forEach(post => this.add(post));
    });
  })
  .catch(err => console.error('Failed to load search index', err));

function displayResults(results) {
  resultsList.innerHTML = '';
  results.forEach(r => {
    const post = posts.find(p => p.url === r.ref);
    if (post) {
      const li = document.createElement('li');
      const a = document.createElement('a');
      a.href = post.url;
      a.textContent = post.title;
      li.appendChild(a);
      resultsList.appendChild(li);
    }
  });
}

searchInput.addEventListener('input', () => {
  const query = searchInput.value.trim();
  if (!query || !index) {
    resultsList.innerHTML = '';
    return;
  }
  const results = index.search(query);
  displayResults(results);
});
</script>
